<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>buttress-db test</title>

    <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script>
    <script src="../node_modules/wct-browser-legacy/browser.js"></script>

    <script type="module" src="../buttress-db.js"></script>
  </head>
  <body>

    <test-fixture id="buttress-db-fixture">
      <template>
        <buttress-db
          endpoint="http://test.buttressjs.com",
          app-id="45tRsh1R0Vo80ANAAJEs8gFB5NNk4A14",
          api-path="bjs",
          user-id="1",
          token="I8N9hRAZhcJZQB4kM41YIc8o11M5VpwYl1Qc" 
        ></buttress-db>
      </template>
    </test-fixture>

    <script>
      suite('buttress-db', () => {
        var element;

        setup(function() {
          element = fixture('buttress-db-fixture');
        });

        test('should instantiating the element with default properties works', () => {
          assert.isFalse(element.loaded, 'property loaded property is false');
          assert.isOk(element.loading, 'has property loading');
          assert.isFalse(element.error, 'property error property is false');
          assert.isOk(element.settings, 'has property settings')
          assert.isOk(element.db, 'has property db');
          assert.isOk(element.io, 'has property io');
        });

        test('should load database with app schema', (done) => {
          element.addEventListener('loaded-changed', function() {
            assert.equal(element.loaded, element.loaded, 'property loaded is true');
            assert.isOk(element.db.board, 'board collection should be loaded from app schema');
            assert.isOk(element.db.company, 'company collection should be loaded from app schema');
            assert.isOk(element.db.post, 'post collection should be loaded from app schema');
            assert.isOk(element.db.service, 'service collection should be loaded from app schema');
            done();
          });
        });
      });
    </script>
  </body>
</html>
